grant select on rev_bihier to config;

grant select on rev_locale_hier to config;

CREATE OR REPLACE VIEW VIEW_REV_BIHIER AS 
SELECT 
/*+MATERIALIZE*/
RB.HIER_CODE, RB.UNIQUE_CODE,RLH.LOCALE_DESCRIPTION FROM ATOMIC.REV_BIHIER RB
INNER JOIN ATOMIC.REV_LOCALE_HIER RLH ON RB.METADATA_GUID=RLH.METADATA_GUID 
AND RB.SHRT_DESC=RLH.METADATA_KEY
AND RB.VERSION_NO=RLH.VERSION_NO
WHERE RB.VERSION_NO=0;

grant select on VIEW_REV_BIHIER to config;